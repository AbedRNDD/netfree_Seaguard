<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- تعطيل 3D transforms قبل تحميل Leaflet -->
    <script>
        var L_NO_TOUCH = true;
        var L_DISABLE_3D = true;
    </script>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        html, body { 
            width: 100%; 
            height: 100%; 
            overflow: hidden; 
        }
        #map { 
            width: 100%; 
            height: 100%; 
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // إنشاء الخريطة بدون أنيميشن + استخدام Canvas
        var map = L.map('map', {
            center: [20, 0],
            zoom: 2,
            zoomControl: false,
            attributionControl: false,
            preferCanvas: true,
            zoomAnimation: false,
            fadeAnimation: false,
            markerZoomAnimation: false
        });

        // إضافة طبقة البلاطات
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            minZoom: 2,
            updateWhenIdle: false,
            updateWhenZooming: false,
            keepBuffer: 2
        }).addTo(map);

        // المواقع
        var locations = [
            {lat: 35.0, lng: -40.0, name: "Spooknet #1", user: "OceanGuard21", date: "28-11-2025"},
            {lat: -15.0, lng: -50.0, name: "Spooknet #2", user: "SeaProtector", date: "27-11-2025"},
            {lat: 35.0, lng: 15.0, name: "Spooknet #3", user: "WaveWatcher", date: "26-11-2025"},
            {lat: -10.0, lng: 70.0, name: "Spooknet #4", user: "NetHunter", date: "25-11-2025"},
            {lat: -25.0, lng: 135.0, name: "Spooknet #5", user: "CoastGuard", date: "24-11-2025"},
            {lat: 10.0, lng: -150.0, name: "Spooknet #6", user: "PacificWatch", date: "23-11-2025"}
        ];

        // أيقونة مخصصة
        var icon = L.divIcon({
            html: '<div style="background:#ef4444;width:16px;height:16px;border-radius:50%;border:3px solid white;box-shadow:0 2px 5px rgba(0,0,0,0.4)"></div>',
            iconSize: [16, 16],
            iconAnchor: [8, 8],
            className: ''
        });

        // إضافة العلامات
        locations.forEach(function(loc) {
            var marker = L.marker([loc.lat, loc.lng], {icon: icon}).addTo(map);
            marker.bindPopup('<b>' + loc.name + '</b><br>Gebruiker: ' + loc.user + '<br>Datum: ' + loc.date);
        });

        // وظائف التكبير/التصغير
        window.map = map;
        window.zoomIn = function() { 
            map.zoomIn(); 
            setTimeout(function() { map.invalidateSize(); }, 100);
        };
        window.zoomOut = function() { 
            map.zoomOut(); 
            setTimeout(function() { map.invalidateSize(); }, 100);
        };

        // إعادة حساب الحجم عند التحميل
        setTimeout(function() { 
            map.invalidateSize(); 
        }, 300);

        // إعادة حساب الحجم عند تغيير حجم النافذة
        window.addEventListener('resize', function() { 
            map.invalidateSize(); 
        });
    </script>
</body>
</html>
